let searchInput=document.getElementById("search-input"),searchButton=document.getElementById("search-button"),loader=document.getElementById("loader"),errorMessage=document.getElementById("error-message"),weatherCard=document.getElementById("weather-card"),forecastPanel=document.getElementById("forecast-panel"),cityName=document.getElementById("city-name"),currentDate=document.getElementById("current-date"),temperature=document.getElementById("temperature"),weatherDescription=document.getElementById("weather-description"),weatherIcon=document.getElementById("weather-icon"),humidity=document.getElementById("humidity"),windSpeed=document.getElementById("wind-speed"),feelsLike=document.getElementById("feels-like"),forecastContainer=document.getElementById("forecast-container"),weatherBackground=document.querySelector(".weather-background"),WEATHER_API_KEY="6e965de3d3117e309b1c1ebf9989cf53",PIXABAY_API_KEY="45450559-21280a32042e78d1eabd94a26",currentCity="Goa";function formatDate(e){return e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function showLoader(){loader.classList.remove("hidden"),weatherCard.classList.add("hidden"),forecastPanel.classList.add("hidden"),errorMessage.classList.add("hidden")}function hideLoader(){loader.classList.add("hidden")}function showError(e){errorMessage.textContent=e,errorMessage.classList.remove("hidden")}function getWeatherIcon(e){let t="";switch(e.toLowerCase()){case"clear":case"sunny":t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>';break;case"clouds":case"cloudy":case"partly cloudy":t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"></path></svg>';break;case"rain":case"drizzle":t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"></path><path d="M16 14v6"></path><path d="M8 14v6"></path><path d="M12 16v6"></path></svg>';break;case"thunderstorm":t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 16.9A5 5 0 0 0 18 7h-1.26a8 8 0 1 0-11.62 9"></path><path d="m13 12-3 5h4l-2 4"></path></svg>';break;case"snow":t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 17.58A5 5 0 0 0 18 8h-1.26A8 8 0 1 0 4 16.25"></path><path d="M8 16h.01"></path><path d="M8 20h.01"></path><path d="M12 18h.01"></path><path d="M12 22h.01"></path><path d="M16 16h.01"></path><path d="M16 20h.01"></path></svg>';break;case"mist":case"fog":case"haze":t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 17.58A5 5 0 0 0 18 8h-1.26A8 8 0 1 0 4 16.25"></path><line x1="5" y1="20" x2="19" y2="20"></line></svg>';break;default:t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"></path></svg>'}return t}function getBackgroundGradient(e,t="day"){if("night"===t)switch(e.toLowerCase()){case"clear":return"linear-gradient(to bottom, #0c1445 0%, #203a43 50%, #2c5364 100%)";case"clouds":return"linear-gradient(to bottom, #2c3e50 0%, #4c5c68 100%)";case"rain":return"linear-gradient(to bottom, #1c2b4a 0%, #2c3e50 100%)";case"thunderstorm":return"linear-gradient(to bottom, #0f2027 0%, #203a43 50%, #2c5364 100%)";case"snow":return"linear-gradient(to bottom, #2c3e50 0%, #3498db 100%)";default:return"linear-gradient(to bottom, #0f2027 0%, #203a43 50%, #2c5364 100%)"}else switch(e.toLowerCase()){case"clear":return"linear-gradient(to bottom, #00b4db 0%, #0083b0 100%)";case"clouds":return"linear-gradient(to bottom, #757f9a 0%, #d7dde8 100%)";case"rain":return"linear-gradient(to bottom, #3a7bd5 0%, #3a6073 100%)";case"thunderstorm":return"linear-gradient(to bottom, #373b44 0%, #4286f4 100%)";case"snow":return"linear-gradient(to bottom, #e6dada 0%, #274046 100%)";default:return"linear-gradient(to bottom, #2980b9 0%, #6dd5fa 50%, #ffffff 100%)"}}async function fetchWeather(e){showLoader();try{var t=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${e}&appid=${WEATHER_API_KEY}&units=metric`);if(!t.ok)throw new Error("City not found. Please try another location.");var a=await t.json(),r=await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${e}&appid=${WEATHER_API_KEY}&units=metric`);if(!r.ok)throw new Error("Forecast data not available.");var n=await r.json(),o=(displayWeather(a),n.list.filter((e,t)=>t%8==0));displayForecast(o),fetchBackgroundImage(e,a.weather[0].main),hideLoader(),weatherCard.classList.remove("hidden"),forecastPanel.classList.remove("hidden"),currentCity=e}catch(e){hideLoader(),showError(e.message)}}function displayWeather(e){var t=e.name,{temp:a,humidity:r,feels_like:n}=e.main,{description:o,main:i}=e.weather[0],e=e.wind.speed;cityName.textContent=t,currentDate.textContent=formatDate(new Date),temperature.textContent=Math.round(a)+"°C",weatherDescription.textContent=o,weatherIcon.innerHTML=getWeatherIcon(i),humidity.textContent=r+"%",windSpeed.textContent=e+" km/h",feelsLike.textContent=Math.round(n)+"°C"}function displayForecast(e){forecastContainer.innerHTML="",e.forEach(e=>{var t=new Date(1e3*e.dt).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),a=Math.round(e.main.temp),r=e.weather[0].description,e=getWeatherIcon(e.weather[0].main),n=document.createElement("div");n.classList.add("forecast-item"),n.innerHTML=`
            <p class="forecast-date">${t}</p>
            <div class="forecast-icon">${e}</div>
            <p class="forecast-temp">${a}°C</p>
            <p class="forecast-desc">${r}</p>
        `,forecastContainer.appendChild(n)})}async function fetchBackgroundImage(e,t){try{var a,r=await(await fetch(`https://pixabay.com/api/?key=${PIXABAY_API_KEY}&q=${e}+${t}&image_type=photo`)).json();0<r.hits.length?weatherBackground.style.backgroundImage=`url(${r.hits[0].largeImageURL})`:0<(a=await(await fetch(`https://pixabay.com/api/?key=${PIXABAY_API_KEY}&q=${e}&image_type=photo`)).json()).hits.length?weatherBackground.style.backgroundImage=`url(${a.hits[0].largeImageURL})`:(weatherBackground.style.backgroundImage="none",weatherBackground.style.background=getBackgroundGradient(t))}catch(e){console.error("Error fetching background image:",e),weatherBackground.style.backgroundImage="none",weatherBackground.style.background=getBackgroundGradient(t)}}searchButton.addEventListener("click",()=>{var e=searchInput.value.trim();e&&fetchWeather(e)}),searchInput.addEventListener("keypress",e=>{"Enter"===e.key&&(e=searchInput.value.trim())&&fetchWeather(e)}),window.addEventListener("load",()=>{fetchWeather(currentCity)});